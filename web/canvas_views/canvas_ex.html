<HTML>
<body>

<div id="canvas-svg"></div>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<button type="button" onclick="toggleEdges">Show Edges</button>

<script> 
var WIDTH = 1200, HEIGHT = 600;

var w = WIDTH,
	h = HEIGHT;

var showEdges = false;
	
var force = d3.layout.force()
			.charge(-45)
			.gravity(0.06)
			.size([w, h]);
			
var vis = d3.select("body").append("canvas")
			//.append("svg")
			.attr("width", w)
			.attr("height", h);
			
var context = vis.node().getContext("2d");

var toggleEdges = function() {
	showEdges = !showEdges;
	console.log(showEdges);
};

d3.json("025425K.json", function(error, graph) {
	force
		.nodes(graph.nodes)
		.links(graph.links)
		.start();
		
		
		setInterval(function() {
			console.log("Timer Event");
			force.on("tick", drawGraph);
		}, 5000);
					
	var link = vis.selectAll(".link")
      .data(graph.links)
    .enter().append("line")
      .attr("class", "link")
      .style("stroke-width", function(d) { return Math.sqrt(d.value); })
	  .style("stroke", "#999");
		
	var node = vis.selectAll(".node")
		.data(graph.nodes)
		.enter()
		.append("circle")
		.attr("class", "node")
		.attr("r", 5)
		.style("fill", function(d) { return "red"; })
      .call(force.drag);


	  
  node.append("title")
      .text(function(d) { return d.name; });

  force.on("tick", updatePos);
  
  var updatePos = function() {
	node.attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; });
  
  };
  
  var drawGraph = function() {
	 context.clearRect(0, 0, WIDTH, HEIGHT);
  
  
  // draw links
  if(showEdges) {
	context.strokeStyle = "#ccc";
	context.beginPath();
	graph.links.forEach(function(d) {
		context.moveTo(d.source.x, d.source.y);
		context.lineTo(d.target.x, d.target.y);
	});
	context.stroke();
  }
    // draw nodes
  context.fillStyle = "steelblue";
  context.beginPath();
  graph.nodes.forEach(function(d) {
    context.moveTo(d.x, d.y);
    context.arc(d.x, d.y, 4.5, 0, 2 * Math.PI);
  });
  context.fill();

};  


});

</script>

</body>
</HTML>